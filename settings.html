<!-- Enhanced settings.html for Attachment Remover Extension -->
<div class="attachment-remover-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>üóëÔ∏è Attachment Remover</b>
            <div class="inline-drawer-icon fa-solid fa-chevron-down down"></div>
        </div>
        
        <div class="inline-drawer-content">
            <!-- Status Indicator -->
            <div class="attachment-remover-status">
                <span id="attachmentRemoverStatusIcon">üî¥</span>
                <strong id="attachmentRemoverStatusText">Extension Disabled</strong>
                <small>Current mode: <span id="attachmentRemoverMode">Inactive</span></small>
            </div>
            
            <!-- Description with icon -->
            <div class="attachment-remover-description">
                <p>üöÄ <strong>Automatically clean attachments</strong> after AI responses. Reduces memory usage and keeps chat history tidy!</p>
            </div>
            
            <!-- Main Toggle -->
            <div class="form-group">
                <label class="checkbox_label" for="attachment_remover_enable">
                    <input type="checkbox" id="attachment_remover_enable">
                    <span class="setting-title">
                        <strong>üîå Enable Attachment Removal</strong>
                        <small>Master switch for all removal functions</small>
                    </span>
                </label>
            </div>
            
            <hr>
            
            <!-- Removal Settings -->
            <div class="attachment-remover-section">
                <h4><i class="fa-solid fa-sliders"></i> Removal Settings</h4>
                
                <div class="form-group">
                    <label class="checkbox_label" for="attachment_remover_all_messages">
                        <input type="checkbox" id="attachment_remover_all_messages">
                        <span class="setting-title">
                            <strong>üìö Remove from All User Messages</strong>
                            <small>Clean entire conversation instead of just latest message</small>
                        </span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label class="checkbox_label" for="attachment_remover_images_only">
                        <input type="checkbox" id="attachment_remover_images_only">
                        <span class="setting-title">
                            <strong>üñºÔ∏è Images Only Mode</strong>
                            <small>Preserve documents, audio files, and other attachments</small>
                        </span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label class="checkbox_label" for="attachment_remover_preserve_first">
                        <input type="checkbox" id="attachment_remover_preserve_first">
                        <span class="setting-title">
                            <strong>‚≠ê Preserve First Message</strong>
                            <small>Keep attachments in your initial message</small>
                        </span>
                    </label>
                </div>
            </div>
            
            <hr>
            
            <!-- Advanced Options -->
            <div class="attachment-remover-advanced">
                <h4><i class="fa-solid fa-microchip"></i> Advanced Options</h4>
                
                <div class="form-group">
                    <label class="checkbox_label" for="attachment_remover_auto_cleanup">
                        <input type="checkbox" id="attachment_remover_auto_cleanup">
                        <span class="setting-title">
                            <strong>üßπ Automatic Cleanup</strong>
                            <small>Optimize chat memory after removal</small>
                        </span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label class="checkbox_label" for="attachment_remover_debug">
                        <input type="checkbox" id="attachment_remover_debug">
                        <span class="setting-title">
                            <strong>üêõ Debug Mode</strong>
                            <small>Show detailed logs in console (F12)</small>
                        </span>
                    </label>
                </div>
                
                <!-- Manual Control -->
                <div class="form-group">
                    <button id="attachmentRemoverManualButton" class="menu_button">
                        <i class="fa-solid fa-broom"></i> Clean Attachments Now
                    </button>
                    <small class="manual-hint">Manually remove attachments from current chat</small>
                </div>
            </div>
            
            <hr>
            
            <!-- Statistics & Info -->
            <div class="attachment-remover-stats">
                <h4><i class="fa-solid fa-chart-bar"></i> Statistics</h4>
                <div class="stats-grid">
                    <div class="stat-item">
                        <strong id="attachmentsRemovedCount">0</strong>
                        <small>Total Removed</small>
                    </div>
                    <div class="stat-item">
                        <strong id="lastRemovalTime">Never</strong>
                        <small>Last Cleanup</small>
                    </div>
                    <div class="stat-item">
                        <strong id="memorySaved">0 KB</strong>
                        <small>Memory Saved</small>
                    </div>
                </div>
            </div>
            
            <!-- Help Section -->
            <div class="attachment-remover-help">
                <h4><i class="fa-solid fa-circle-question"></i> Help & Guidance</h4>
                
                <details>
                    <summary><strong>How It Works</strong></summary>
                    <div class="help-content">
                        <ol>
                            <li>Extension waits for AI response</li>
                            <li>Scans backward through user messages</li>
                            <li>Removes attachments based on your settings</li>
                            <li>Stops at previous AI message or chat start</li>
                        </ol>
                        <div class="selector-code">
                            // Detection Logic:<br>
                            messages.findLastIndex(msg => msg.matches('.mes_left'))
                        </div>
                    </div>
                </details>
                
                <details>
                    <summary><strong>Optimization Tips</strong></summary>
                    <div class="help-content">
                        <p><strong>For best performance:</strong></p>
                        <ul>
                            <li>Use "Images Only" mode for large chats</li>
                            <li>Enable "Preserve First Message" for character cards</li>
                            <li>Combine with Automatic Cleanup for memory savings</li>
                        </ul>
                    </div>
                </details>
                
                <details>
                    <summary><strong>Troubleshooting</strong></summary>
                    <div class="help-content">
                        <p><strong>Attachments not removing?</strong></p>
                        <ul>
                            <li>Check the master enable switch</li>
                            <li>Enable debug mode and check console (F12)</li>
                            <li>Try manual cleanup with the broom button</li>
                            <li>Refresh SillyTavern (F5)</li>
                        </ul>
                    </div>
                </details>
            </div>
            
            <!-- Footer with version -->
            <div class="attachment-remover-footer">
                <small>Attachment Remover v1.2 | SillyTavern Extension</small>
                <small id="extensionVersion">Loading version...</small>
            </div>
        </div>
    </div>
</div>